<!DOCTYPE html>
<html ng-app="nodeApp"><!--Es el module que creamos-->
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
    	<title>Aplicaci칩n Node CRUD Jugadores</title>
    	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css">
	</head>
	<body ng-controller="mainCtrl"><!--Es el controller que creamos-->
		<div class="container">
			<div class="page-header">
			  	<h1>Listado jugadores</h1>
			</div>
			<div class="row">
				<div class="col-sm-4">
					<div class="checkbox" ng-repeat="i in jugadores">
						<label>{{ i.nombre }}</label>
						<button class="btn-primary" ng-click="deleteJugador(i._id)">Borrar</button>
					</div>
				</div>
			</div>

			<div class="page-header">
			  	<h1>A침adir jugador</h1>
			</div>
			<div class="row">
				<div class="col-sm-4">
					<form>
					    <div class="form-group">
					        <input id="nombre" name="nombre" type="text" class="form-control" placeholder="Nombre">
					    </div>
					    <div class="form-group">
					        <input id="edad" name="edad" type="number" class="form-control" placeholder="Edad">
					    </div>
					    <div class="form-group">
					        <input id="equipo" name="equipo" type="text" class="form-control" placeholder="Equipo">
					    </div>
					    <div class="form-group">
					        <input id="demarcacion" name="demarcacion" type="text" class="form-control" placeholder="Demarcacion">
					    </div>
					    <button class="btn btn-primary" ng-click="anadirJugador()">A침adir</button>
					</form>
				</div>
			</div>
		</div>

		<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    	<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.min.js"></script>
    	<script type="text/javascript">
    		//Module asignado a la variable del ng-app del html
			var nodeApp = angular.module('nodeApp', []);
			//Controller del module que se llama como el ng-controller del body
			nodeApp.controller('mainCtrl', function ($scope,$http) {
			    $scope.formData = {};

			    $http.get('/jugadores')
			        .success(function(data) {
			            $scope.jugadores = data;
			            console.log(data)
			        })
			        .error(function(data) {
			            console.log('Error: ' + data);
			        });


			    // Cuando se a침ade un nuevo jugador, manda el texto a la API
			    $scope.anadirJugador = function(){
			    	$scope.formData={
			    		"nombre":$("#nombre").val(),
			    		/*"edad":$("#edad").val(),
			    		"equipo":$("#equipo").val(),
			    		"demarcacion":$("#demarcacion").val()*/
			    		"edad":30,
			    		"equipo":"Glorioso",
			    		"demarcacion":"Delantero"
			    	}
			    	//$scope.jugadores=$scope.formData;
			        $http.post('/jugador', $scope.formData)
			            .success(function(data) {
			                $scope.formData = {};
			                $scope.jugadores = data;
			            })
			            .error(function(data) {
			                console.log('Error:' + data);
			            });
			    };

			    // Borra un TODO despues de checkearlo como acabado
				$scope.deleteJugador = function(id) {
					$http.delete('/jugador/' + id)
						.success(function(data) {
							$scope.jugadores = data;
							console.log(data);
						})
						.error(function(data) {
							console.log('Error:' + data);
						});
				};
			});
    	</script>
	</body>
</html>